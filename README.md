# íŒŸìºìŠ¤íŠ¸ RSS í”¼ë“œ ìƒì„±ê¸°

> íŒŸë¹µ, Spotify, YouTube ì½˜í…ì¸ ë¥¼ iTunes í˜¸í™˜ RSS í”¼ë“œë¡œ ë³€í™˜í•˜ì—¬ ì›í•˜ëŠ” íŒŸìºìŠ¤íŠ¸ ì•±ì—ì„œ êµ¬ë… ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” ì„œë¹„ìŠ¤

[![NestJS](https://img.shields.io/badge/NestJS-E0234E?style=flat&logo=nestjs&logoColor=white)](https://nestjs.com/)
[![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?style=flat&logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![Supabase](https://img.shields.io/badge/Supabase-3ECF8E?style=flat&logo=supabase&logoColor=white)](https://supabase.com/)

---

## ëª©ì°¨

- [í”„ë¡œì íŠ¸ ì†Œê°œ](#-í”„ë¡œì íŠ¸-ì†Œê°œ)
- [ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
- [ë¹ ë¥¸ ì‹œì‘](#-ë¹ ë¥¸-ì‹œì‘)
- [í™˜ê²½ ì„¤ì •](#-í™˜ê²½-ì„¤ì •)
- [API ì‚¬ìš©ë²•](#-api-ì‚¬ìš©ë²•)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)

---

## í”„ë¡œì íŠ¸ ì†Œê°œ

### ë¬¸ì œ ìƒí™©
- íŒŸë¹µ, Spotify, YouTube ì½˜í…ì¸ ë¥¼ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” í”Œë ˆì´ì–´ì—ì„œ ì¬ìƒí•  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŒ

### í•´ê²° ë°©ë²•
ê° í”Œë«í¼ì˜ ì½˜í…ì¸ ë¥¼ **í‘œì¤€ RSS í”¼ë“œ**ë¡œ ë³€í™˜í•˜ì—¬, ì‚¬ìš©ìê°€ ì›í•˜ëŠ” í”Œë ˆì´ì–´ì—ì„œ ììœ ë¡­ê²Œ ì¬ìƒí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

### ì§€ì› í”Œë«í¼
| í”Œë«í¼ | ìƒíƒœ | ì„¤ëª… |
|--------|------|------|
| **íŒŸë¹µ** | ì™„ë²½ ì§€ì› | ê³µì‹ API ì‚¬ìš©, ì˜¤ë””ì˜¤ ì™„ë²½ ì œê³µ |
| **Spotify** | ëŒ€ë¶€ë¶„ ì§€ì› | ê³µì‹ API ì‚¬ìš©, ë‹¨ë… ê³„ì•½ ì±„ë„ ì œì™¸ ì˜¤ë””ì˜¤ ì œê³µ |
| **YouTube** | ì‹¤í—˜ì  | ì˜¤ë””ì˜¤ ì¶”ì¶œ ê°€ëŠ¥í•˜ë‚˜ ì•½ê´€/ì„±ëŠ¥/ìœ ì§€ë³´ìˆ˜ë¹„ìš© ì´ìŠˆ ìˆìŒ |

---

## ì£¼ìš” ê¸°ëŠ¥

- **íŒŸë¹µ RSS ìƒì„±**: ì±„ë„ IDë¡œ ì¦‰ì‹œ RSS í”¼ë“œ ìƒì„±
- **Spotify ì—°ë™**: Spotify íŒŸìºìŠ¤íŠ¸ë¥¼ Apple Podcasts RSSë¡œ ë³€í™˜
- **YouTube RSS ìƒì„±**: YouTube ì½˜í…ì¸ ì—ì„œ ì˜¤ë””ì˜¤ë§Œ ì¶”ì¶œ ë° ì €ì¥, ì €ì¥ëœ urlì„ ì´ìš©í•´ RSS í”¼ë“œ ìƒì„±
- **ìë™ ì—…ë°ì´íŠ¸**: ë§¤ì‹œê°„ ìë™ìœ¼ë¡œ ìƒˆ ì—í”¼ì†Œë“œ ìˆ˜ì§‘ (íŒŸë¹µ, Spotify)
- **iTunes í˜¸í™˜**: ëª¨ë“  íŒŸìºìŠ¤íŠ¸ ì•±ì—ì„œ êµ¬ë… ê°€ëŠ¥í•œ í‘œì¤€ RSS í˜•ì‹
- **ì±„ë„ ê´€ë¦¬**: ë“±ë¡í•œ ì±„ë„ ì¡°íšŒ, ì‚­ì œ, ì—…ë°ì´íŠ¸

---

## ë¹ ë¥¸ ì‹œì‘

### 1. ì‚¬ì „ ìš”êµ¬ì‚¬í•­

- **Node.js** 18.x ì´ìƒ
- **npm**
- **Supabase** ê³„ì •
- **Cloudflare R2** ê³„ì • 
- **Spotify API** í‚¤

### 2. ì„¤ì¹˜

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone <repository-url>
cd <folder-name>

# ì˜ì¡´ì„± ì„¤ì¹˜
npm install
```

### 3. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— `.env` íŒŒì¼ ìƒì„±:

```env
# í•„ìˆ˜: Supabase ì„¤ì •
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_BUCKET_NAME=your-supabase-bucket-name

# Spotify API
SPOTIFY_CLIENT_ID=your_spotify_client_id
SPOTIFY_CLIENT_SECRET=your_spotify_client_secret

# Cloudflare R2
R2_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
R2_ACCESS_KEY_ID=your_r2_access_key
R2_ACCOUNT_ID=tour_r2_account_id
R2_BUCKET_NAME=your_bucket_name
R2_PUBLIC_URL=https://your-r2-domain.com
DOWNLOAD_FOLDER=youtube

# Base Url
FRONTEND_URL=your-published-domain
```

### 4. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

Supabaseì—ì„œ ì•„ë˜ SQLì„ ì‹¤í–‰í•˜ì—¬ í…Œì´ë¸” ìƒì„±:

```sql
CREATE TABLE channels (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  url TEXT,
  thumbnail TEXT,
  type TEXT NOT NULL,
  videos JSONB,
  description TEXT,
  summary TEXT,
  author TEXT,
  copyright TEXT,
  owner JSONB,
  language TEXT DEFAULT 'ko',
  category TEXT,
  content_type TEXT,
  publisher TEXT,
  host TEXT,
  tags JSONB,
  external_rss_url TEXT,
  added_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  last_update TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### 5. ì„œë²„ ì‹¤í–‰

```bash
# ê°œë°œ ëª¨ë“œ (Hot Reload)
npm run start:dev

# í”„ë¡œë•ì…˜ ëª¨ë“œ
npm run build
npm run start:prod
# ë°°í¬í™˜ê²½ì— ë”°ë¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ
```

ì„œë²„ê°€ `http://localhost:3000`ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.

### 6. í…ŒìŠ¤íŠ¸

```bash
# í—¬ìŠ¤ ì²´í¬
curl http://localhost:3000/api/health

# ì‘ë‹µ: {"status":"ok"}
```

---

## í™˜ê²½ ì„¤ì •

### Supabase ì„¤ì • ë°©ë²•

1. [Supabase](https://supabase.com) ê°€ì… ë° í”„ë¡œì íŠ¸ ìƒì„±
2. `Settings` â†’ `API` ë©”ë‰´ì—ì„œ ë‹¤ìŒ ì •ë³´ ë³µì‚¬:
   - `Project URL` â†’ `SUPABASE_URL`
   - `anon public` í‚¤ â†’ `SUPABASE_KEY`
3. SQL Editorì—ì„œ ìœ„ì˜ í…Œì´ë¸” ìƒì„± SQL ì‹¤í–‰

### Spotify API ì„¤ì • ë°©ë²• (ì„ íƒ)

1. [Spotify Developer Dashboard](https://developer.spotify.com/dashboard) ì ‘ì†
2. ì•± ìƒì„± í›„ `Client ID`ì™€ `Client Secret` ë³µì‚¬
3. `.env` íŒŒì¼ì— ì¶”ê°€

### Cloudflare R2 ì„¤ì • ë°©ë²• (ì„ íƒ, YouTube ì‚¬ìš© ì‹œ)

1. [Cloudflare Dashboard](https://dash.cloudflare.com/) â†’ R2 ë©”ë‰´
2. ë²„í‚· ìƒì„±
3. API í† í° ìƒì„± í›„ `.env` íŒŒì¼ì— ì¶”ê°€
4. ê³µê°œ ë„ë©”ì¸ ì„¤ì • (R2 Public URL)

---

## ğŸ“š API ì‚¬ìš©ë²•

> Base URL: `http://localhost:3000` (ê°œë°œ í™˜ê²½)
> ë°°í¬ ì‹œ ë°°í¬ í™˜ê²½ ë„ë©”ì¸ ì ìš© í•„ìˆ˜

### íŒŸë¹µ

#### 1. íŒŸë¹µ ì±„ë„ ID ì°¾ê¸°

íŒŸë¹µ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì›í•˜ëŠ” ì±„ë„ URLì„ í™•ì¸:
```
ì˜ˆ: https://www.podbbang.com/channels/1789807
                                         â†‘
                                    ì±„ë„ ID
```

#### 2. RSS í”¼ë“œ ìƒì„±

```bash
curl -X POST http://localhost:3000/api/podbbang/channel \
  -H "Content-Type: application/json" \
  -d '{"channelId": "1789807"}'
```

**ì‘ë‹µ:**
```json
{
  "rssUrl": "http://localhost:3000/rss/podbbang_1789807"
}
```

#### 3. ì±„ë„ ì—…ë°ì´íŠ¸

ë§¤ì‹œê°„ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì§€ë§Œ, ìˆ˜ë™ìœ¼ë¡œë„ ê°€ëŠ¥:

```bash
curl -X POST http://localhost:3000/api/podbbang/update/1789807
```

---

### Spotify

#### 1. Spotify ì‡¼ URL í™•ì¸

```
ì˜ˆ: https://open.spotify.com/show/3IM0lmZxpFAY7CwMuv9H4g
                                   â†‘
                              ì‡¼ ID
```

#### 2. RSS ì°¾ê¸° (Apple Podcasts ì—°ë™)

```bash
curl -X POST http://localhost:3000/api/spotify/find-rss \
  -H "Content-Type: application/json" \
  -d '{"spotifyUrl": "https://open.spotify.com/show/3IM0lmZxpFAY7CwMuv9H4g"}'
```

**ì„±ê³µ ì‹œ:**
```json
{
  "feedUrl": "https://feeds.acast.com/...",
  "channelId": "spotify_3IM0lmZxpFAY7CwMuv9H4g"
}
```

**ì‹¤íŒ¨ ì‹œ:**
```json
{
  "error": "Podcast not found on Apple Podcasts"
}
```

---

### YouTube

YouTube ê¸°ëŠ¥ì€ ë‹¤ìŒ ì´ìœ ë¡œ í”„ë¡œë•ì…˜ ì‚¬ìš©ì„ ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤:
- YouTube ì„œë¹„ìŠ¤ ì•½ê´€ ìœ„ë°˜ ê°€ëŠ¥ì„±
- ì €ì‘ê¶Œ ë¬¸ì œ
- ë†’ì€ ì²˜ë¦¬ ì‹œê°„ (í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ 100ê°œ = 1-3ì‹œê°„)
- ë†’ì€ ì €ì¥ ê³µê°„ ë¹„ìš©

#### YouTube URL ì²˜ë¦¬

```bash
curl -X POST http://localhost:3000/youtube/process \
  -H "Content-Type: application/json" \
  -d '{"url": "https://www.youtube.com/watch?v=VIDEO_ID"}'
```

**ì£¼ì˜**:
- ë¹„ë””ì˜¤ë‹¹ 30ì´ˆ~2ë¶„ ì†Œìš”
- 100ê°œ ë¹„ë””ì˜¤ = ì•½ 1-3ì‹œê°„
- R2 ì €ì¥ ê³µê°„ í•„ìš”

---

### ì±„ë„ ê´€ë¦¬

#### ëª¨ë“  ì±„ë„ ì¡°íšŒ

```bash
curl http://localhost:3000/api/channels
```

#### ì±„ë„ ì‚­ì œ

```bash
curl -X DELETE http://localhost:3000/api/channel/podbbang_1789807
```

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”œâ”€â”€ podbbang/          # íŒŸë¹µ ê´€ë ¨ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ spotify/           # Spotify ê´€ë ¨ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ youtube/           # YouTube ê´€ë ¨ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ apple-podcasts/    # Apple Podcasts ê²€ìƒ‰
â”‚   â”‚   â”œâ”€â”€ rss/               # RSS í”¼ë“œ ìƒì„±
â”‚   â”‚   â””â”€â”€ channel/           # ì±„ë„ ê´€ë¦¬ API
â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â”œâ”€â”€ channel-db.service.ts  # DB ì‘ì—…
â”‚   â”‚       â””â”€â”€ supabase.service.ts    # Supabase ì—°ê²°
â”‚   â”œâ”€â”€ types/                 # TypeScript íƒ€ì… ì •ì˜
â”‚   â”œâ”€â”€ tasks/                 # í¬ë¡  ì‘ì—… (ìë™ ì—…ë°ì´íŠ¸)
â”‚   â””â”€â”€ main.ts                # ì•± ì§„ì…ì 
â”œâ”€â”€ .env                       # í™˜ê²½ ë³€ìˆ˜
â””â”€â”€ package.json
```

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

- **Backend**: NestJS (Node.js + TypeScript)
- **Database**: Supabase (PostgreSQL)
- **Storage**: Cloudflare R2 (S3 í˜¸í™˜)
- **YouTube**: yt-dlp, ytpl
- **Scheduler**: @nestjs/schedule (Cron)

---
